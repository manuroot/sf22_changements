{% extends "ApplicationChangementsBundle::layout.html.twig" %}
{% form_theme edit_form 'MopaBootstrapBundle:Form:fields.html.twig' %}

{% block stylesheets %}
{{ parent() }}
<link rel="stylesheet" href="{{ asset('bundles/applicationchangements/css/sliding.css') }}" type="text/css" media="all"/>
<link rel="stylesheet" href="{{ asset('select2/select2.css') }}" type="text/css" media="all"/>
<style>
        .monlabel {
            font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
            font-weight: bold;
        }
        .boxlist {
            border: 1px solid #D4E0EE;
              background-color: #f1f1f1;
              padding-left:15px;
              padding-right:5px;
              position:relative;
            width:90%;

        }

         #boxleft {
            border: 1px solid #D4E0EE;
              margin-top:30px;
            margin-left:30px;
            margin-bottom:30px;
            width:30%;
               position:relative;
            float:left;

        }
        #boxright {
            border: 1px solid #D4E0EE;
            margin-top:30px;
            margin-left:30px;
              margin-bottom:30px;
            background-color: #f1f1f1;
           float:left;
            
            width:60%;

        }

        .mytextarea {
            border: 1px solid #D4E0EE;
            background-color: #f1f1f1;
            width:330px; height:100px;

        }
        .leserreurs {
            font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
            font-weight: bold;
            font-size:18px;
            color:red;
        }
        tr.single {
         background-color: #f1f1f1;
        }
       ul#myTab.nav.nav-tabs{
           background-color: whitesmoke;
           }
      /*   
            .table-mybordered {
        width:auto;
  
        margin-left:auto;
        margin-right:auto;
      box-shadow: 1px 1px 1px #999; 
    border-width: 1px 1px 1px 1px;
    border-style: solid solid solid solid;
 border-spacing: 1px;
    border-color: black -moz-use-text-color;
    -moz-border-top-colors: black;
    -moz-border-right-colors: black;
    -moz-border-bottom-colors: black;
    -moz-border-left-colors: black;
    border-image: none;
    border-collapse: separate;
    border-radius: 6px 6px 6px 6px;
    margin-bottom:50px;
    
}*/
        div.tab-content{
      
        width:auto;
        min-width:60%;
        margin-left:auto;
        margin-right:auto;
      box-shadow: 1px 1px 1px #999; 
    border-width: 1px 1px 1px 1px;
    border-style: solid solid solid solid;
 border-spacing: 1px;
    border-color: black -moz-use-text-color;
    -moz-border-top-colors: black;
    -moz-border-right-colors: black;
    -moz-border-bottom-colors: black;
    -moz-border-left-colors: black;
    border-image: none;
    border-collapse: separate;
    border-radius: 6px 6px 6px 6px;
    margin-bottom:50px;
       padding-top:10px;
                padding-bottom:20px;
            padding-left:20px;
            
          background-color: #ABC6DD;
        
        }

    </style> 
{% endblock %}

{% block javascripts %}
{{ parent() }}
   <script type="text/javascript" src="{{ asset('select2/select2.js') }}"></script>
   <script type="text/javascript" src="{{ asset('select2/select2_locale_fr.js') }}"></script>

{{ tinymce_init() }}
   <script>
  
$(document).ready(function() {
    $("#e1").select2();
});
// Récupère le div qui contient la collection de tags
var collectionHolder = $('ul.tags');
var mybutton_add = '<button class="btn btn-small btn-primary"><i class="icon-plus-sign"></i> Ajouter Fichier</button>';
var mybutton_del = '<button class="btn btn-small btn-danger"><i class="icon-remove-sign"></i> Supprimer Fichier</button>';
// ajoute un lien « add a tag »

//var $addTagLink = $('<hr class="hrsep"><a href="#" class="add_tag_link">' + mybutton_add + '</a>');
var $addTagLink = $('<a href="#" class="add_tag_link">' + mybutton_add + '</a>');
//var $addTagLink = $('<hr><a href="#" class="add_tag_link"><button id="show" type="submit" name="submit-filter" class="btn btn-small btn-primary"><i class="icon-plus-sign"></i>Ajouter Fichier</button></a>');
var $newLinkLi = $('<td class="fichier"></td>').append($addTagLink);

jQuery(document).ready(function() {
    // ajoute l'ancre « ajouter un tag » et li à la balise ul
  
    collectionHolder.find('td.fichier').each(function() {
        addTagFormDeleteLink($(this));
    });
      collectionHolder.append($newLinkLi);
    $addTagLink.on('click', function(e) {
        // empêche le lien de créer un « # » dans l'URL
        e.preventDefault();

        // ajoute un nouveau formulaire tag (voir le prochain bloc de code)
        addTagForm(collectionHolder, $newLinkLi);
    });
});
function addTagForm(collectionHolder, $newLinkLi) {
    // Récupère l'élément ayant l'attribut data-prototype comme expliqué plus tôt
    var prototype = collectionHolder.attr('data-prototype');

    // Remplace '__name__' dans le HTML du prototype par un nombre basé sur
    // la longueur de la collection courante
    var newForm = prototype.replace(/__name__/g, collectionHolder.children().length);

    // Affiche le formulaire dans la page dans un li, avant le lien "ajouter un tag"
    var $newFormLi = $('<td.fichier></td>').append(newForm);
    $newLinkLi.before($newFormLi);
    // ajoute un lien de suppression au nouveau formulaire
    addTagFormDeleteLink($newFormLi);
}
function addTagFormDeleteLink($tagFormLi) {
    var $removeFormA = $('<a href="#">' + mybutton_del  + '</a><hr class="hrsep">');
    $tagFormLi.append($removeFormA);

    $removeFormA.on('click', function(e) {
        // empêche le lien de créer un « # » dans l'URL
        e.preventDefault();

        // supprime l'élément li pour le formulaire de tag
        $tagFormLi.remove();
    });
}
  
       </script>
        <script type="text/javascript" src="{{ asset('bundles/applicationchangements/js/datenew.js') }}"></script>
  
    
   
    <script>    
    $( "#tabs" ).tabs();
   $( "#tabs a " ).tabs();
    $('#myTab a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
    });
   {{ form_javascript(edit_form) }}
</script>
{% endblock %}
       
 
 
 

{% block content_header '' %}
{% block title %}EDITION CHANGEMENT{% endblock %}
{% block content %}

<form action="{{ path('changements_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>
<ul class="nav nav-tabs" id="myTab">
<li class="active"><a href="#home">Main</a></li>
<li><a href="#profile">Fichiers</a></li>
<li><a href="#messages">Liste Fichiers</a></li>
<li><a href="#settings">Settings</a></li>
</ul>
 
  
<div class="tab-content">
<div class="tab-pane active" id="home">   
   <table class="table-mybordered">

            <tr><td class="calendar">
                        <div> {{ form_row(edit_form.nom) }}</div>
                        <div> {{ form_row(edit_form.dateDebut) }} </div>
                        <div>{{ form_row(edit_form.dateFin) }} </div>
                        <div>{{ form_row(edit_form.dateComep) }}</div>
                        <div> {{ form_row(edit_form.dateVsr) }}</div>
                 <div>
                         
                                    {{ form_row(edit_form.description,{ 'attr': {'class': 'tinymce'} }) }}
                               
                         
         </div>
                        </td>
            </tr></table>
</div>
   
<div class="tab-pane" id="profile">
          <h3>FICHIERS</h3>
          <ul class="tags" data-prototype="{{ form_widget(edit_form.picture.vars.prototype)|e }}">
          <table>
    

    
        {% for tag in edit_form.picture %}
        <tr>
            <td class="fichier">{{ form_widget(tag) }}
      
                </td>
                 </tr>
        {% endfor %}
   
    </table>
                    {% do edit_form.picture.setRendered() %}
                      
                       


</div>
<div class="tab-pane" id="messages"> <h3><center>Liste des Fichiers associés</center></h3>
  <table><tbody><tr>     
      <td class="calendar">
                            <div>
                            {{ form_row(edit_form.idProjet) }}</div>
                                <div class="boxlist">{{ form_row(edit_form.idEnvironnement) }}</div>
                                <br>
                                <div class="boxlist">{{ form_row(edit_form.idStatus) }}</div>
                                <br>
                              
                                </td>
                              <td class="calendar">{{ form_rest(edit_form) }} </td>
                            </tr>
                            <tr>  <tr><td class="calendar" colspan="3">
                                    <button type="submit" class="btn btn-small btn-warning">Modifier</button>
                                    <a href="{{ path('changements_post') }}" class="btn btn-small btn-success">Retour</a>
                                    </form>


                                    <form action="{{ path('changements_delete', { 'id': entity.id }) }}" method="post">
                                     {{ form_errors(delete_form) }}
                                     {{ form_row(delete_form.id) }}
                                     {{ form_rest(delete_form) }}
                                            <div style="text-align:right">
                                                <button type="submit" class="btn btn-small btn-danger" onclick="if(!confirm('Are you sure?')) { return false; }">Supprimer Projet</button>
                                            </div>
                                        </form>
                                    </td></tr>
                            </tbody>
                        </table>     
</div>
<div class="tab-pane" id="settings">...</div>
</div>
  </form>   
 {% endblock %}


